// =====================
// CONFIGURACIÃ“N
// =====================
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// =====================
// ENUMS
// =====================
enum status_enum {
  Activo
  Inactivo
}

enum worker_role {
  Admin
  Warehouse
}

enum client_type_enum {
  Persona
  Empresa
}

enum document_type_enum {
  DNI
  RUC
}

enum role_enum {
  Administrador
  Cliente
  Trabajador
}

// =====================
// USER
// =====================
model User {
  id_user          String             @id @default(uuid())
  auth_id          String             @unique
  email            String             @unique

  phone            String?
  first_name       String?
  last_name        String?
  document_type    document_type_enum?
  document_number  String?            @unique
  role             role_enum?

  status           status_enum         @default(Activo)
  created_at       DateTime            @default(now())
  updated_at       DateTime            @default(now()) @updatedAt

  worker           Worker?
  client           Client?
}

// =====================
// WORKER
// =====================
model Worker {
  id_worker          String      @id @default(uuid())
  id_user            String      @unique
  role               worker_role
  employment_status  status_enum @default(Activo)
  hired_at           DateTime    @default(now())

  user               User        @relation(fields: [id_user], references: [id_user])
}

// =====================
// CLIENT
// =====================
model Client {
  id_client               String          @id @default(uuid())
  id_user                 String          @unique
  address                 String?
  profile_picture         String?
  client_type             client_type_enum?
  needs_password_change   Boolean @default(true)
  created_by_admin        Boolean @default(false)
  is_extra_data_completed Boolean @default(false)
  registered_at           DateTime        @default(now())

  user           User            @relation(fields: [id_user], references: [id_user])
  client_company ClientCompany?
}

// =====================
// CLIENT COMPANY 
// =====================
model ClientCompany {
  id_client           String  @id
  company_name        String
  contact_name        String
  client              Client  @relation(fields: [id_client], references: [id_client])
}

// =====================
// PRODUCT
// =====================
model Product {
  id          String   @id @default(uuid())
  name        String
  description String?
  sku         String   @unique
  price       Float
  stock       Int
  is_active   Boolean  @default(true)
  created_at  DateTime @default(now())
  updated_at  DateTime @default(now()) @updatedAt
}